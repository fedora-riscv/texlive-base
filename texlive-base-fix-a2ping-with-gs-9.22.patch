diff -up texlive-base-20170520/source/texk/texlive/linked_scripts/a2ping/a2ping.pl.gs922 texlive-base-20170520/source/texk/texlive/linked_scripts/a2ping/a2ping.pl
--- texlive-base-20170520/source/texk/texlive/linked_scripts/a2ping/a2ping.pl.gs922	2018-03-11 14:15:15.824669043 -0400
+++ texlive-base-20170520/source/texk/texlive/linked_scripts/a2ping/a2ping.pl	2018-03-11 14:15:21.803523499 -0400
@@ -352,7 +352,7 @@ use just +1; # a JustLib application
 use strict;
 use integer;
 use Htex::papers;
-BEGIN { $Htex::a2ping::VERSION="2.77p" }
+BEGIN { $Htex::a2ping::VERSION="2.77p1" }
 
 # Imp: option to ignore `%%Orientation: Portrait', which gs respects and rotates by 90 degrees if necessary
 # Imp: gs(704?!) sometimes finds too small bbox, see Univers.eps
@@ -401,7 +401,7 @@ BEGIN { $Htex::a2ping::VERSION="2.77p" }
 
 ### program identification
 my $program = "a2ping.pl";
-my $filedate="2006-11-15"; # my $filedate="2001/03/05";
+my $filedate="2018-03-07"; # my $filedate="2001/03/05";
 my $copyright = "Written by <pts\@fazekas.hu> from April 2003.
 This is free software, GNU GPL >=2.0. There is NO WARRANTY.
 (epstopdf 2.7 Copyright 1998-2001 by Sebastian Rahtz et al.)\n";
@@ -1543,12 +1543,13 @@ count /OPCOUNT exch def
       (bbox-success\n) ..print
       quit
     } if
-    .callbeginpage
   }
+  % Run the previous contents of /BeginPage: {--.callbeginpage--}
+  [exch aload pop currentpagedevice /BeginPage get aload pop] cvx
 >> setpagedevice
 
 % vvv do these after our call to /setpagedevice
-.currentglobal true .setglobal
+currentglobal true setglobal
 systemdict begin
 /..paper.redef<< >>def
 /..print/print load def
@@ -1657,7 +1658,7 @@ dup/= exch def /print exch def
   pop
 }forall} forall
 end % systemdict
-.setglobal
+setglobal
 systemdict readonly pop
 
 (bbox-begin\n) ..print
@@ -2570,3 +2571,9 @@ texutil.
  * separated FileFormat features to FL_* constants
  * added --doc
  * there is no default FileFormat (PDF) anymore
+
+=head2 2018-03-07 v2.77p1 (Szab� P�ter)
+
+ * .callbeginpage and .setglobal fix for Ghostscript 9.22
+   (https://bugs.ghostscript.com/show_bug.cgi?id=699063).
+   Problem reported by Akira Yokosawa
